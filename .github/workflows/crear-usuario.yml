name: Crear README.md para nuevo usuario

on:
  push:
    paths:
      - 'Usuarios/**'

jobs:
  create_readme:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repositorio
        uses: actions/checkout@v2

      - name: Configurar identidad de usuario de Git
        run: |
          git config --global user.email "your-email@example.com"
          git config --global user.name "Your Name"

      - name: Crear README.md para nuevo usuario
        run: |
          # Obtener el nombre de la carpeta del usuario desde el evento
          USER_DIR_PATH=$(echo ${GITHUB_EVENT_PATH} | sed 's/.*\/Usuarios\///')

          # DepuraciÃ³n: Verificar que la ruta del usuario estÃ© correcta
          echo "USER_DIR_PATH: ${USER_DIR_PATH}"

          # Asegurarse de que la ruta no sea vacÃ­a
          if [ -n "$USER_DIR_PATH" ]; then
            # Crear la ruta completa para el directorio del usuario
            USER_DIR="Usuarios/${USER_DIR_PATH}"

            # Crear el archivo README.md con las instrucciones para el nuevo usuario
            echo "# Bienvenido a tu perfil en BookTrack, ${USER_DIR_PATH}!" > "${USER_DIR}/README.md"
            echo "" >> "${USER_DIR}/README.md"
            echo "## Pasos para comenzar:" >> "${USER_DIR}/README.md"
            echo "1. **Sube tus libros** ðŸ“š" >> "${USER_DIR}/README.md"
            echo "   Crea un archivo con el nombre del libro y detalles (autor, descripciÃ³n, etc.) dentro de la carpeta \`Libros/\`." >> "${USER_DIR}/README.md"
            echo "2. **Ãšnete a un club** ðŸ“–" >> "${USER_DIR}/README.md"
            echo "   Visita la carpeta \`Clubs/\` y Ãºnete al club que mÃ¡s te interese." >> "${USER_DIR}/README.md"
            echo "3. **Actualiza tu perfil** âœï¸" >> "${USER_DIR}/README.md"
            echo "   Actualiza tu archivo \`PERFIL.md\` con la informaciÃ³n de tus libros y clubes." >> "${USER_DIR}/README.md"

            # Hacer commit y push de los cambios
            git add "${USER_DIR}/README.md"
            git commit -m "Crear README.md para el usuario ${USER_DIR_PATH}"
            git push
          else
            echo "No se pudo identificar la ruta del usuario"
            exit 1
          fi
