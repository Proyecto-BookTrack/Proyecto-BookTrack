name: Crear README.md para nuevo usuario

on:
  push:
    paths:
      - 'Usuarios/**'  # Detecta cualquier cambio en la carpeta Usuarios

jobs:
  create_readme:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repositorio
        uses: actions/checkout@v2

      - name: Crear README.md para nuevo usuario
        run: |
          # Obtener el nombre del directorio del usuario desde el evento
          USER_DIR_PATH=$(echo ${GITHUB_EVENT_PATH} | sed 's/.*\/Usuarios\///')

          # Comprobar si USER_DIR_PATH no est치 vac칤o
          if [ -n "$USER_DIR_PATH" ]; then
            # Asegurarnos de que la ruta se trata como un directorio v치lido
            USER_DIR="Usuarios/${USER_DIR_PATH}"

            # Crear README.md con las instrucciones en la carpeta del usuario
            echo "# Bienvenido a tu perfil en BookTrack, ${USER_DIR_PATH}!" > "${USER_DIR}/README.md"
            echo "" >> "${USER_DIR}/README.md"
            echo "## Pasos para comenzar:" >> "${USER_DIR}/README.md"
            echo "1. **Sube tus libros** 游닄" >> "${USER_DIR}/README.md"
            echo "   Crea un archivo con el nombre del libro y detalles (autor, descripci칩n, etc.) dentro de la carpeta \`Libros/\`." >> "${USER_DIR}/README.md"
            echo "2. **칔nete a un club** 游닀" >> "${USER_DIR}/README.md"
            echo "   Visita la carpeta \`Clubs/\` y 칰nete al club que m치s te interese." >> "${USER_DIR}/README.md"
            echo "3. **Actualiza tu perfil** 九꽲잺" >> "${USER_DIR}/README.md"
            echo "   Actualiza tu archivo \`PERFIL.md\` con la informaci칩n de tus libros y clubes." >> "${USER_DIR}/README.md"

            # Hacer commit y push de los cambios
            git add "${USER_DIR}/README.md"
            git commit -m "Crear README.md para el usuario ${USER_DIR_PATH}"
            git push
          else
            echo "No se pudo identificar la ruta del usuario"
            exit 1
          fi
